<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web Components Demo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Ubuntu Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      padding: 2rem;
      background: #f0f2f5;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      margin-bottom: 1rem;
      color: #5200e7;
    }

    .section {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      margin-bottom: 2rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .section-title {
      font-size: 1.25rem;
      margin-bottom: 1rem;
      color: #333;
      border-bottom: 2px solid #5200e7;
      padding-bottom: 0.5rem;
    }

    .controls {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    button {
      padding: 0.75rem 1.5rem;
      background: #5200e7;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s;
    }

    button:hover {
      background: #3d00b0;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(82, 0, 231, 0.3);
    }

    button.secondary {
      background: #6c757d;
    }

    button.secondary:hover {
      background: #5a6268;
    }

    .event-log {
      background: #f8f9fa;
      padding: 1rem;
      border-radius: 6px;
      margin-top: 1rem;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 0.875rem;
    }

    .event-log-entry {
      padding: 0.25rem 0;
      border-bottom: 1px solid #dee2e6;
    }

    .event-log-entry:last-child {
      border-bottom: none;
    }

    .timestamp {
      color: #6c757d;
      margin-right: 0.5rem;
    }

    .event-type {
      color: #5200e7;
      font-weight: 600;
    }

    code {
      background: #f1f3f5;
      padding: 0.125rem 0.25rem;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
    }

    .badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      background: #28a745;
      color: white;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }

    .lifecycle-log {
      background: #e7f5ff;
      padding: 1rem;
      border-left: 4px solid #228be6;
      margin-top: 1rem;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéØ Web Components Demo <span class="badge">Live</span></h1>
    <p style="margin-bottom: 2rem; color: #666;">
      Demonstra√ß√£o dos componentes web nativos com lifecycle completo, Shadow DOM e reatividade.
    </p>

    <!-- Statistics Component -->
    <div class="section">
      <h2 class="section-title">1. <code>&lt;civic-statistics&gt;</code> Component</h2>
      <p style="margin-bottom: 1rem; color: #666;">
        Componente reativo com auto-refresh, observa√ß√£o de atributos e eventos customizados.
      </p>

      <div class="controls">
        <button onclick="updateStatistics()">Update Statistics</button>
        <button onclick="toggleAutoRefresh()" class="secondary">Toggle Auto-Refresh</button>
        <button onclick="toggleTheme()" class="secondary">Toggle Theme</button>
      </div>

      <civic-statistics
        id="stats"
        data-source="/api/statistics"
        theme="light">
      </civic-statistics>

      <div class="lifecycle-log" id="statsLifecycle">
        <strong>Lifecycle Events:</strong>
        <div id="statsLifecycleLog"></div>
      </div>
    </div>

    <!-- Filters Component -->
    <div class="section">
      <h2 class="section-title">2. <code>&lt;citizen-filters&gt;</code> Component</h2>
      <p style="margin-bottom: 1rem; color: #666;">
        Componente de filtros com eventos personalizados e estado reativo.
      </p>

      <citizen-filters id="filters"></citizen-filters>

      <div class="event-log" id="filterEvents">
        <strong>Filter Events:</strong>
        <div id="filterEventLog"></div>
      </div>
    </div>

    <!-- Component Info -->
    <div class="section">
      <h2 class="section-title">üìä Component Information</h2>
      <div id="componentInfo"></div>
    </div>
  </div>

  <!-- Load Web Components -->
  <script type="module">
    // Import and register components
    import { registerAllComponents } from './js/web-components/index.js';

    // Event logging
    const statsEl = document.getElementById('stats');
    const filtersEl = document.getElementById('filters');
    const filterEventLog = document.getElementById('filterEventLog');
    const statsLifecycleLog = document.getElementById('statsLifecycleLog');

    // Log filter events
    filtersEl.addEventListener('filter-change', (e) => {
      logEvent('filter-change', e.detail);
    });

    filtersEl.addEventListener('filter-reset', (e) => {
      logEvent('filter-reset', e.detail);
    });

    // Log statistics events
    statsEl.addEventListener('statistics-loaded', (e) => {
      logLifecycle('statistics-loaded', e.detail);
    });

    statsEl.addEventListener('statistics-error', (e) => {
      logLifecycle('statistics-error', e.detail);
    });

    function logEvent(type, detail) {
      const entry = document.createElement('div');
      entry.className = 'event-log-entry';
      entry.innerHTML = `
        <span class="timestamp">${new Date().toLocaleTimeString()}</span>
        <span class="event-type">${type}</span>
        ${detail ? `: ${JSON.stringify(detail)}` : ''}
      `;
      filterEventLog.prepend(entry);

      // Keep only last 10 entries
      while (filterEventLog.children.length > 10) {
        filterEventLog.removeChild(filterEventLog.lastChild);
      }
    }

    function logLifecycle(type, detail) {
      const entry = document.createElement('div');
      entry.innerHTML = `‚Ä¢ ${type} at ${new Date().toLocaleTimeString()}`;
      statsLifecycleLog.appendChild(entry);
    }

    // Global functions for buttons
    window.updateStatistics = function() {
      statsEl.statistics = {
        total: Math.floor(Math.random() * 200),
        sent: Math.floor(Math.random() * 150),
        responded: Math.floor(Math.random() * 100),
        pending: Math.floor(Math.random() * 50)
      };
    };

    let autoRefreshEnabled = false;
    window.toggleAutoRefresh = function() {
      autoRefreshEnabled = !autoRefreshEnabled;
      if (autoRefreshEnabled) {
        statsEl.setAttribute('auto-refresh', '3000');
      } else {
        statsEl.removeAttribute('auto-refresh');
      }
    };

    let currentTheme = 'light';
    window.toggleTheme = function() {
      currentTheme = currentTheme === 'light' ? 'dark' : 'light';
      statsEl.setAttribute('theme', currentTheme);
    };

    // Component info
    setTimeout(() => {
      const info = document.getElementById('componentInfo');
      info.innerHTML = `
        <p><strong>Registered Components:</strong></p>
        <ul>
          <li><code>civic-statistics</code> - ${statsEl.constructor.name}</li>
          <li><code>citizen-filters</code> - ${filtersEl.constructor.name}</li>
        </ul>
        <p style="margin-top: 1rem;"><strong>Shadow DOM:</strong></p>
        <ul>
          <li>Statistics Shadow Root: ${statsEl.shadowRoot ? '‚úÖ Active' : '‚ùå None'}</li>
          <li>Filters Shadow Root: ${filtersEl.shadowRoot ? '‚úÖ Active' : '‚ùå None'}</li>
        </ul>
      `;
    }, 100);

    // Initialize with mock data
    setTimeout(() => {
      updateStatistics();
      logLifecycle('Component initialized', null);
    }, 500);
  </script>
</body>
</html>
